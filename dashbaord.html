<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eviction Case Management Dashboard | Houston County</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700&family=Merriweather:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <style>
        :root {
            --houston-blue: #003366;
            --houston-red: #b22234;
            --houston-gold: #f0b323;
            --georgia-blue: #0f2044;
            --georgia-red: #ae1a1f;
            --light-gray: #f8f9fa;
            --dark-gray: #343a40;
            --border-radius: 8px;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --success-green: #28a745;
            --warning-orange: #fd7e14;
            --info-blue: #17a2b8;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Open Sans', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f5f7fa;
            display: flex;
            min-height: 100vh;
        }
        
        /* Sidebar */
        .sidebar {
            width: 250px;
            background: linear-gradient(to bottom, var(--houston-blue), var(--georgia-blue));
            color: white;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            box-shadow: 2px 0 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
        }
        
        .sidebar-header {
            padding: 25px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }
        
        .sidebar-header h1 {
            font-family: 'Merriweather', serif;
            font-size: 22px;
            margin-bottom: 5px;
            color: var(--houston-gold);
        }
        
        .sidebar-header p {
            font-size: 12px;
            opacity: 0.8;
        }
        
        .nav-links {
            list-style: none;
            padding: 20px 0;
        }
        
        .nav-links li {
            margin-bottom: 5px;
        }
        
        .nav-links a {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }
        
        .nav-links a:hover,
        .nav-links a.active {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border-left-color: var(--houston-gold);
        }
        
        .nav-links i {
            width: 25px;
            font-size: 18px;
            margin-right: 12px;
        }
        
        .nav-links .badge {
            background: var(--houston-red);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            margin-left: auto;
        }
        
        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            position: absolute;
            bottom: 0;
            width: 100%;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            background: var(--houston-gold);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--houston-blue);
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            margin-left: 250px;
            padding: 20px;
            min-height: 100vh;
        }
        
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .header h2 {
            color: var(--houston-blue);
            font-family: 'Merriweather', serif;
            font-size: 28px;
        }
        
        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .search-box {
            position: relative;
        }
        
        .search-box input {
            padding: 10px 40px 10px 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            width: 300px;
        }
        
        .search-box i {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }
        
        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--box-shadow);
            display: flex;
            align-items: center;
            gap: 20px;
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
        }
        
        .stat-icon.total { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .stat-icon.pending { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .stat-icon.processing { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .stat-icon.completed { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
        
        .stat-info h3 {
            font-size: 12px;
            text-transform: uppercase;
            color: #666;
            margin-bottom: 5px;
        }
        
        .stat-number {
            font-size: 32px;
            font-weight: 700;
            color: var(--houston-blue);
            margin-bottom: 5px;
        }
        
        .stat-change {
            font-size: 12px;
            color: #666;
        }
        
        .stat-change.positive { color: var(--success-green); }
        .stat-change.negative { color: var(--houston-red); }
        
        /* Main Content Area */
        .content-area {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .content-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .content-header h3 {
            color: var(--houston-blue);
            font-family: 'Merriweather', serif;
            font-size: 22px;
        }
        
        .table-controls {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        
        .btn {
            padding: 10px 20px;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            font-family: 'Open Sans', sans-serif;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background-color: var(--houston-blue);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: var(--georgia-blue);
        }
        
        .btn-success {
            background-color: var(--success-green);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #218838;
        }
        
        .btn-outline {
            background-color: white;
            color: var(--houston-blue);
            border: 2px solid var(--houston-blue);
        }
        
        .btn-outline:hover {
            background-color: var(--houston-blue);
            color: white;
        }
        
        .btn-sm {
            padding: 6px 12px;
            font-size: 14px;
        }
        
        /* DataTable Customization */
        .dataTables_wrapper {
            margin-top: 20px;
        }
        
        table.dataTable {
            border-collapse: collapse !important;
            margin-top: 0 !important;
        }
        
        table.dataTable thead th {
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
            color: var(--houston-blue);
            font-weight: 600;
            padding: 15px;
        }
        
        table.dataTable tbody td {
            padding: 15px;
            border-bottom: 1px solid #f0f0f0;
            vertical-align: middle;
        }
        
        table.dataTable tbody tr:hover {
            background-color: #f8f9fa;
        }
        
        /* Status Badges */
        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            display: inline-block;
        }
        
        .status-submitted { background: #e3f2fd; color: #1976d2; }
        .status-processing { background: #fff3e0; color: #f57c00; }
        .status-approved { background: #e8f5e9; color: #388e3c; }
        .status-rejected { background: #ffebee; color: #d32f2f; }
        .status-filed { background: #f3e5f5; color: #7b1fa2; }
        
        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            background: var(--houston-blue);
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h3 {
            margin: 0;
            font-family: 'Merriweather', serif;
        }
        
        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            line-height: 1;
        }
        
        .modal-body {
            padding: 30px;
            max-height: calc(90vh - 140px);
            overflow-y: auto;
        }
        
        .case-details-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .detail-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: var(--border-radius);
        }
        
        .detail-section h4 {
            color: var(--houston-blue);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .detail-item {
            margin-bottom: 10px;
            display: flex;
        }
        
        .detail-label {
            font-weight: 600;
            width: 120px;
            color: #666;
        }
        
        .detail-value {
            flex: 1;
            color: #333;
        }
        
        .documents-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .document-card {
            border: 1px solid #e0e0e0;
            border-radius: var(--border-radius);
            padding: 20px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .document-card:hover {
            border-color: var(--houston-blue);
            box-shadow: var(--box-shadow);
        }
        
        .document-icon {
            font-size: 40px;
            color: var(--houston-blue);
            margin-bottom: 10px;
        }
        
        .document-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
        }
        
        /* Loading Overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 3000;
            display: none;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid var(--houston-blue);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
                overflow: visible;
            }
            
            .sidebar-header h1,
            .sidebar-header p,
            .nav-links span,
            .sidebar-footer span {
                display: none;
            }
            
            .main-content {
                margin-left: 70px;
            }
            
            .search-box input {
                width: 200px;
            }
            
            .header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
        <p style="color: white; margin-top: 20px;">Loading...</p>
    </div>

    <!-- Sidebar -->
    <div class="sidebar">
        <div class="sidebar-header">
            <h1>Case Manager</h1>
            <p>Houston County Eviction System</p>
        </div>
        
        <ul class="nav-links">
            <li><a href="#" class="active" id="navDashboard">
                <i class="fas fa-tachometer-alt"></i>
                <span>Dashboard</span>
            </a></li>
            
            <li><a href="#" id="navCases">
                <i class="fas fa-folder"></i>
                <span>All Cases</span>
                <span class="badge" id="totalCasesBadge">0</span>
            </a></li>
            
            <li><a href="#" id="navPending">
                <i class="fas fa-clock"></i>
                <span>Pending Review</span>
                <span class="badge" id="pendingCasesBadge">0</span>
            </a></li>
            
            <li><a href="#" id="navProcessing">
                <i class="fas fa-cog"></i>
                <span>Processing</span>
                <span class="badge" id="processingCasesBadge">0</span>
            </a></li>
            
            <li><a href="#" id="navApproved">
                <i class="fas fa-check-circle"></i>
                <span>Approved</span>
                <span class="badge" id="approvedCasesBadge">0</span>
            </a></li>
            
            <li><a href="#" id="navRejected">
                <i class="fas fa-times-circle"></i>
                <span>Rejected</span>
                <span class="badge" id="rejectedCasesBadge">0</span>
            </a></li>
            
            <li><a href="#" id="navFiled">
                <i class="fas fa-gavel"></i>
                <span>Court Filed</span>
                <span class="badge" id="filedCasesBadge">0</span>
            </a></li>
            
            <li><a href="#" id="navReports">
                <i class="fas fa-chart-bar"></i>
                <span>Reports</span>
            </a></li>
            
            <li><a href="#" id="navSettings">
                <i class="fas fa-cog"></i>
                <span>Settings</span>
            </a></li>
        </ul>
        
        <div class="sidebar-footer">
            <div class="user-info">
                <div class="user-avatar">AD</div>
                <div>
                    <div style="font-weight: 600;">Admin User</div>
                    <div style="font-size: 12px; opacity: 0.8;">Court Administrator</div>
                </div>
            </div>
            <button class="btn btn-outline" style="width: 100%; color: white; border-color: white;">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Header -->
        <div class="header">
            <h2>Eviction Case Management Dashboard</h2>
            <div class="header-actions">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Search cases...">
                    <i class="fas fa-search"></i>
                </div>
                <button class="btn btn-primary" id="refreshBtn">
                    <i class="fas fa-sync-alt"></i>
                    Refresh
                </button>
                <button class="btn btn-success" id="newCaseBtn">
                    <i class="fas fa-plus"></i>
                    Add Manual Case
                </button>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon total">
                    <i class="fas fa-folder"></i>
                </div>
                <div class="stat-info">
                    <h3>Total Cases</h3>
                    <div class="stat-number" id="totalCases">0</div>
                    <div class="stat-change">
                        <i class="fas fa-arrow-up"></i>
                        <span>12% from last month</span>
                    </div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon pending">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="stat-info">
                    <h3>Pending Review</h3>
                    <div class="stat-number" id="pendingCases">0</div>
                    <div class="stat-change">
                        <i class="fas fa-arrow-up"></i>
                        <span>3 new today</span>
                    </div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon processing">
                    <i class="fas fa-cog"></i>
                </div>
                <div class="stat-info">
                    <h3>Processing</h3>
                    <div class="stat-number" id="processingCases">0</div>
                    <div class="stat-change">
                        <i class="fas fa-arrow-down"></i>
                        <span>5 completed today</span>
                    </div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon completed">
                    <i class="fas fa-check-circle"></i>
                </div>
                <div class="stat-info">
                    <h3>Court Filed</h3>
                    <div class="stat-number" id="filedCases">0</div>
                    <div class="stat-change positive">
                        <i class="fas fa-arrow-up"></i>
                        <span>8 filed this week</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Cases Table -->
        <div class="content-area">
            <div class="content-header">
                <h3>All Eviction Cases</h3>
                <div class="table-controls">
                    <select id="statusFilter" class="select2" style="width: 150px;">
                        <option value="">All Status</option>
                        <option value="submitted">Submitted</option>
                        <option value="processing">Processing</option>
                        <option value="approved">Approved</option>
                        <option value="rejected">Rejected</option>
                        <option value="filed">Court Filed</option>
                    </select>
                    
                    <select id="dateFilter" class="select2" style="width: 150px;">
                        <option value="">All Time</option>
                        <option value="today">Today</option>
                        <option value="week">This Week</option>
                        <option value="month">This Month</option>
                        <option value="quarter">This Quarter</option>
                    </select>
                    
                    <button class="btn btn-outline" id="exportBtn">
                        <i class="fas fa-download"></i>
                        Export
                    </button>
                </div>
            </div>
            
            <table id="casesTable" class="display" style="width:100%">
                <thead>
                    <tr>
                        <th>Case ID</th>
                        <th>Landlord</th>
                        <th>Tenant</th>
                        <th>Property Address</th>
                        <th>Amount Owed</th>
                        <th>Status</th>
                        <th>Submitted</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="casesTableBody">
                    <!-- Cases will be loaded here -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Case Details Modal -->
    <div class="modal" id="caseDetailsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Case Details</h3>
                <button class="modal-close" id="closeDetailsModal">&times;</button>
            </div>
            <div class="modal-body" id="caseDetailsContent">
                <!-- Case details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Assign Case Number Modal -->
    <div class="modal" id="assignCaseModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Assign Official Case Number</h3>
                <button class="modal-close" id="closeAssignModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group" style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;">
                        Official Court Case Number
                    </label>
                    <input type="text" id="officialCaseNumber" class="form-control" 
                           placeholder="e.g., HOU-MC-2024-12345" style="width: 100%; padding: 10px;">
                    <small style="color: #666; display: block; margin-top: 5px;">
                        Format: HOU-MC-YYYY-XXXXX
                    </small>
                </div>
                
                <div class="form-group" style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;">
                        Filing Date
                    </label>
                    <input type="date" id="filingDate" class="form-control" style="width: 100%; padding: 10px;">
                </div>
                
                <div class="form-group" style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;">
                        Clerk Notes
                    </label>
                    <textarea id="clerkNotes" rows="4" class="form-control" 
                              placeholder="Add any notes about this case..." 
                              style="width: 100%; padding: 10px;"></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button class="btn btn-outline" id="cancelAssignBtn">Cancel</button>
                    <button class="btn btn-success" id="saveCaseNumberBtn">Assign Case Number</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize DataTable
        let casesTable;
        let allCases = [];
        let currentFilter = 'all';
        
        $(document).ready(function() {
            // Initialize Select2
            $('.select2').select2({
                minimumResultsForSearch: Infinity
            });
            
            // Initialize DataTable
            casesTable = $('#casesTable').DataTable({
                pageLength: 25,
                order: [[6, 'desc']], // Sort by submission date descending
                columnDefs: [
                    { orderable: false, targets: [7] } // Actions column not sortable
                ],
                language: {
                    search: "Search:",
                    lengthMenu: "Show _MENU_ entries",
                    info: "Showing _START_ to _END_ of _TOTAL_ entries",
                    paginate: {
                        first: "First",
                        last: "Last",
                        next: "Next",
                        previous: "Previous"
                    }
                }
            });
            
            // Load sample data
            loadSampleData();
            
            // Setup event listeners
            setupEventListeners();
            
            // Update stats
            updateStats();
        });
        
        function loadSampleData() {
            const sampleCases = [
                {
                    id: 'HOU-2024-1706092000-1234',
                    landlord: 'John Smith Properties LLC',
                    tenant: 'Robert Johnson',
                    property: '123 Main St, Warner Robins, GA 31088',
                    amount: 1850.00,
                    status: 'submitted',
                    submitted: '2024-01-24 14:30:00',
                    details: {
                        landlordPhone: '(478) 555-0123',
                        landlordEmail: 'john@smithproperties.com',
                        tenantPhone: '(478) 555-9876',
                        tenantEmail: 'rjohnson@email.com',
                        rentAmount: 1200.00,
                        amountOwed: 1850.00,
                        noticeDate: '2024-01-15',
                        noticeDetails: 'Posted on front door on 01/15/2024',
                        reason: 'Non-Payment of Rent',
                        leaseType: 'Month-to-Month',
                        militaryCheck: false,
                        signature: true,
                        documents: [
                            { name: '7-Day Demand Notice', type: 'demand_notice' },
                            { name: 'Dispossessory Affidavit', type: 'affidavit' },
                            { name: 'Summons', type: 'summons' },
                            { name: 'SCRA Verification', type: 'scra_form' }
                        ]
                    }
                },
                {
                    id: 'HOU-2024-1706091800-5678',
                    landlord: 'Mary Wilson',
                    tenant: 'David Miller',
                    property: '456 Oak Ave, Perry, GA 31069',
                    amount: 2450.00,
                    status: 'processing',
                    submitted: '2024-01-23 11:20:00',
                    details: {
                        landlordPhone: '(478) 555-2345',
                        landlordEmail: 'mwilson@email.com',
                        tenantPhone: '(478) 555-8765',
                        tenantEmail: 'dmiller@email.com',
                        rentAmount: 950.00,
                        amountOwed: 2450.00,
                        noticeDate: '2024-01-10',
                        noticeDetails: 'Certified mail #700512345678',
                        reason: 'Lease Violation',
                        leaseType: 'Fixed Term Lease',
                        militaryCheck: true,
                        signature: true,
                        documents: [
                            { name: '7-Day Demand Notice', type: 'demand_notice' },
                            { name: 'Dispossessory Affidavit', type: 'affidavit' },
                            { name: 'Summons', type: 'summons' },
                            { name: 'SCRA Verification', type: 'scra_form' }
                        ]
                    }
                },
                {
                    id: 'HOU-2024-1706091600-9012',
                    landlord: 'Georgia Property Management',
                    tenant: 'Sarah Williams',
                    property: '789 Pine Rd, Centerville, GA 31028',
                    amount: 3200.00,
                    status: 'approved',
                    submitted: '2024-01-22 09:45:00',
                    details: {
                        landlordPhone: '(478) 555-3456',
                        landlordEmail: 'info@gapm.com',
                        tenantPhone: '(478) 555-7654',
                        tenantEmail: 'swilliams@email.com',
                        rentAmount: 1400.00,
                        amountOwed: 3200.00,
                        noticeDate: '2024-01-05',
                        noticeDetails: 'Personal delivery on 01/05/2024',
                        reason: 'Property Damage',
                        leaseType: 'Fixed Term Lease',
                        militaryCheck: false,
                        signature: true,
                        documents: [
                            { name: '7-Day Demand Notice', type: 'demand_notice' },
                            { name: 'Dispossessory Affidavit', type: 'affidavit' },
                            { name: 'Summons', type: 'summons' },
                            { name: 'SCRA Verification', type: 'scra_form' }
                        ]
                    }
                },
                {
                    id: 'HOU-2024-1706091400-3456',
                    landlord: 'Thomas Anderson',
                    tenant: 'Jennifer Brown',
                    property: '321 Elm St, Warner Robins, GA 31088',
                    amount: 950.00,
                    status: 'filed',
                    submitted: '2024-01-21 16:10:00',
                    officialCase: 'HOU-MC-2024-01234',
                    filingDate: '2024-01-22',
                    details: {
                        landlordPhone: '(478) 555-4567',
                        landlordEmail: 'tanderson@email.com',
                        tenantPhone: '(478) 555-6543',
                        tenantEmail: 'jbrown@email.com',
                        rentAmount: 650.00,
                        amountOwed: 950.00,
                        noticeDate: '2024-01-12',
                        noticeDetails: 'Posted and mailed on 01/12/2024',
                        reason: 'Holdover (Lease Expired)',
                        leaseType: 'Month-to-Month',
                        militaryCheck: false,
                        signature: true,
                        documents: [
                            { name: '7-Day Demand Notice', type: 'demand_notice' },
                            { name: 'Dispossessory Affidavit', type: 'affidavit' },
                            { name: 'Summons', type: 'summons' },
                            { name: 'SCRA Verification', type: 'scra_form' }
                        ]
                    }
                },
                {
                    id: 'HOU-2024-1706091200-7890',
                    landlord: 'Davis Realty Group',
                    tenant: 'Michael Taylor',
                    property: '654 Maple Dr, Bonaire, GA 31005',
                    amount: 2100.00,
                    status: 'rejected',
                    submitted: '2024-01-20 13:25:00',
                    rejectionReason: 'Incomplete documentation - Missing signature on affidavit',
                    details: {
                        landlordPhone: '(478) 555-5678',
                        landlordEmail: 'contact@davisrealty.com',
                        tenantPhone: '(478) 555-5432',
                        tenantEmail: 'mtaylor@email.com',
                        rentAmount: 1100.00,
                        amountOwed: 2100.00,
                        noticeDate: '2024-01-08',
                        noticeDetails: 'Posted on door on 01/08/2024',
                        reason: 'Non-Payment of Rent',
                        leaseType: 'Fixed Term Lease',
                        militaryCheck: true,
                        signature: false,
                        documents: [
                            { name: '7-Day Demand Notice', type: 'demand_notice' },
                            { name: 'Dispossessory Affidavit', type: 'affidavit' },
                            { name: 'Summons', type: 'summons' },
                            { name: 'SCRA Verification', type: 'scra_form' }
                        ]
                    }
                }
            ];
            
            allCases = sampleCases;
            updateTable(sampleCases);
        }
        
        function updateTable(cases) {
            casesTable.clear();
            
            cases.forEach(caseItem => {
                const statusBadge = getStatusBadge(caseItem.status);
                const formattedDate = formatDate(caseItem.submitted);
                const amount = formatCurrency(caseItem.amount);
                
                casesTable.row.add([
                    caseItem.id,
                    caseItem.landlord,
                    caseItem.tenant,
                    caseItem.property,
                    amount,
                    statusBadge,
                    formattedDate,
                    generateActionButtons(caseItem.id, caseItem.status)
                ]);
            });
            
            casesTable.draw();
        }
        
        function getStatusBadge(status) {
            const badges = {
                submitted: '<span class="status-badge status-submitted">Submitted</span>',
                processing: '<span class="status-badge status-processing">Processing</span>',
                approved: '<span class="status-badge status-approved">Approved</span>',
                rejected: '<span class="status-badge status-rejected">Rejected</span>',
                filed: '<span class="status-badge status-filed">Court Filed</span>'
            };
            return badges[status] || '<span class="status-badge">Unknown</span>';
        }
        
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
        }
        
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD'
            }).format(amount);
        }
        
        function generateActionButtons(caseId, status) {
            let buttons = `
                <div class="action-buttons">
                    <button class="btn btn-sm btn-outline view-case" data-id="${caseId}">
                        <i class="fas fa-eye"></i>
                    </button>
                    <button class="btn btn-sm btn-outline download-case" data-id="${caseId}">
                        <i class="fas fa-download"></i>
                    </button>
            `;
            
            if (status === 'submitted') {
                buttons += `
                    <button class="btn btn-sm btn-success approve-case" data-id="${caseId}">
                        <i class="fas fa-check"></i>
                    </button>
                    <button class="btn btn-sm btn-outline reject-case" data-id="${caseId}">
                        <i class="fas fa-times"></i>
                    </button>
                `;
            } else if (status === 'approved') {
                buttons += `
                    <button class="btn btn-sm btn-success assign-case" data-id="${caseId}">
                        <i class="fas fa-gavel"></i>
                    </button>
                `;
            }
            
            buttons += `</div>`;
            return buttons;
        }
        
        function setupEventListeners() {
            // Navigation
            $('#navDashboard').click(() => filterCases('all'));
            $('#navCases').click(() => filterCases('all'));
            $('#navPending').click(() => filterCases('submitted'));
            $('#navProcessing').click(() => filterCases('processing'));
            $('#navApproved').click(() => filterCases('approved'));
            $('#navRejected').click(() => filterCases('rejected'));
            $('#navFiled').click(() => filterCases('filed'));
            
            // Buttons
            $('#refreshBtn').click(() => {
                showLoading();
                setTimeout(() => {
                    hideLoading();
                    updateStats();
                }, 500);
            });
            
            $('#newCaseBtn').click(() => {
                alert('Manual case entry feature would open here.');
            });
            
            $('#exportBtn').click(() => {
                exportData();
            });
            
            // Search
            $('#searchInput').on('keyup', function() {
                const searchTerm = $(this).val().toLowerCase();
                const filteredCases = allCases.filter(caseItem => 
                    caseItem.id.toLowerCase().includes(searchTerm) ||
                    caseItem.landlord.toLowerCase().includes(searchTerm) ||
                    caseItem.tenant.toLowerCase().includes(searchTerm) ||
                    caseItem.property.toLowerCase().includes(searchTerm)
                );
                updateTable(filteredCases);
            });
            
            // Status filter
            $('#statusFilter').on('change', function() {
                const status = $(this).val();
                filterCases(status || 'all');
            });
            
            // Date filter
            $('#dateFilter').on('change', function() {
                const period = $(this).val();
                filterByDate(period);
            });
            
            // Modal close buttons
            $('#closeDetailsModal, #closeAssignModal').click(hideModals);
            $('#cancelAssignBtn').click(() => $('#assignCaseModal').hide());
            
            // Click outside modal to close
            $('.modal').click(function(e) {
                if (e.target === this) {
                    hideModals();
                }
            });
            
            // View case details (delegated for dynamic content)
            $(document).on('click', '.view-case', function() {
                const caseId = $(this).data('id');
                showCaseDetails(caseId);
            });
            
            // Download case
            $(document).on('click', '.download-case', function() {
                const caseId = $(this).data('id');
                downloadCase(caseId);
            });
            
            // Approve case
            $(document).on('click', '.approve-case', function() {
                const caseId = $(this).data('id');
                approveCase(caseId);
            });
            
            // Reject case
            $(document).on('click', '.reject-case', function() {
                const caseId = $(this).data('id');
                rejectCase(caseId);
            });
            
            // Assign case number
            $(document).on('click', '.assign-case', function() {
                const caseId = $(this).data('id');
                showAssignModal(caseId);
            });
            
            // Save assigned case number
            $('#saveCaseNumberBtn').click(saveCaseNumber);
        }
        
        function filterCases(status) {
            currentFilter = status;
            
            let filteredCases;
            if (status === 'all') {
                filteredCases = allCases;
            } else {
                filteredCases = allCases.filter(caseItem => caseItem.status === status);
            }
            
            updateTable(filteredCases);
            updateNavActive(status);
        }
        
        function filterByDate(period) {
            if (!period) {
                filterCases(currentFilter);
                return;
            }
            
            const now = new Date();
            let filteredCases = allCases;
            
            if (period === 'today') {
                const today = now.toDateString();
                filteredCases = allCases.filter(caseItem => 
                    new Date(caseItem.submitted).toDateString() === today
                );
            } else if (period === 'week') {
                const weekAgo = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
                filteredCases = allCases.filter(caseItem => 
                    new Date(caseItem.submitted) >= weekAgo
                );
            } else if (period === 'month') {
                const monthAgo = new Date(now.getFullYear(), now.getMonth() - 1, now.getDate());
                filteredCases = allCases.filter(caseItem => 
                    new Date(caseItem.submitted) >= monthAgo
                );
            } else if (period === 'quarter') {
                const quarterAgo = new Date(now.getFullYear(), now.getMonth() - 3, now.getDate());
                filteredCases = allCases.filter(caseItem => 
                    new Date(caseItem.submitted) >= quarterAgo
                );
            }
            
            if (currentFilter !== 'all') {
                filteredCases = filteredCases.filter(caseItem => caseItem.status === currentFilter);
            }
            
            updateTable(filteredCases);
        }
        
        function updateNavActive(status) {
            $('.nav-links a').removeClass('active');
            
            const navMap = {
                'all': '#navCases',
                'submitted': '#navPending',
                'processing': '#navProcessing',
                'approved': '#navApproved',
                'rejected': '#navRejected',
                'filed': '#navFiled'
            };
            
            $(navMap[status] || '#navDashboard').addClass('active');
        }
        
        function updateStats() {
            const total = allCases.length;
            const submitted = allCases.filter(c => c.status === 'submitted').length;
            const processing = allCases.filter(c => c.status === 'processing').length;
            const approved = allCases.filter(c => c.status === 'approved').length;
            const rejected = allCases.filter(c => c.status === 'rejected').length;
            const filed = allCases.filter(c => c.status === 'filed').length;
            
            $('#totalCases').text(total);
            $('#pendingCases').text(submitted);
            $('#processingCases').text(processing);
            $('#filedCases').text(filed);
            
            $('#totalCasesBadge').text(total);
            $('#pendingCasesBadge').text(submitted);
            $('#processingCasesBadge').text(processing);
            $('#approvedCasesBadge').text(approved);
            $('#rejectedCasesBadge').text(rejected);
            $('#filedCasesBadge').text(filed);
        }
        
        function showCaseDetails(caseId) {
            const caseItem = allCases.find(c => c.id === caseId);
            if (!caseItem) return;
            
            const details = caseItem.details;
            let documentsHtml = '';
            
            details.documents.forEach(doc => {
                documentsHtml += `
                    <div class="document-card">
                        <div class="document-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <h4>${doc.name}</h4>
                        <div class="document-actions">
                            <button class="btn btn-sm btn-outline view-doc" data-type="${doc.type}">
                                <i class="fas fa-eye"></i> View
                            </button>
                            <button class="btn btn-sm btn-primary download-doc" data-type="${doc.type}">
                                <i class="fas fa-download"></i> Download
                            </button>
                        </div>
                    </div>
                `;
            });
            
            const caseDetails = `
                <div class="case-details-grid">
                    <div class="detail-section">
                        <h4>Case Information</h4>
                        <div class="detail-item">
                            <span class="detail-label">Case ID:</span>
                            <span class="detail-value">${caseItem.id}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Status:</span>
                            <span class="detail-value">${getStatusText(caseItem.status)}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Submitted:</span>
                            <span class="detail-value">${formatDate(caseItem.submitted)}</span>
                        </div>
                        ${caseItem.officialCase ? `
                        <div class="detail-item">
                            <span class="detail-label">Court Case #:</span>
                            <span class="detail-value" style="color: var(--success-green); font-weight: bold;">
                                ${caseItem.officialCase}
                            </span>
                        </div>
                        ` : ''}
                        ${caseItem.rejectionReason ? `
                        <div class="detail-item">
                            <span class="detail-label">Rejection Reason:</span>
                            <span class="detail-value" style="color: var(--houston-red);">
                                ${caseItem.rejectionReason}
                            </span>
                        </div>
                        ` : ''}
                    </div>
                    
                    <div class="detail-section">
                        <h4>Landlord Information</h4>
                        <div class="detail-item">
                            <span class="detail-label">Name:</span>
                            <span class="detail-value">${caseItem.landlord}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Phone:</span>
                            <span class="detail-value">${details.landlordPhone}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Email:</span>
                            <span class="detail-value">${details.landlordEmail}</span>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h4>Tenant Information</h4>
                        <div class="detail-item">
                            <span class="detail-label">Name:</span>
                            <span class="detail-value">${caseItem.tenant}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Phone:</span>
                            <span class="detail-value">${details.tenantPhone}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Email:</span>
                            <span class="detail-value">${details.tenantEmail}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Military Check:</span>
                            <span class="detail-value">
                                ${details.militaryCheck ? 
                                    '<span style="color: var(--warning-orange);">Yes - Requires SCRA verification</span>' : 
                                    '<span style="color: var(--success-green);">No</span>'}
                            </span>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h4>Property Information</h4>
                        <div class="detail-item">
                            <span class="detail-label">Address:</span>
                            <span class="detail-value">${caseItem.property}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Lease Type:</span>
                            <span class="detail-value">${details.leaseType}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Monthly Rent:</span>
                            <span class="detail-value">${formatCurrency(details.rentAmount)}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Amount Owed:</span>
                            <span class="detail-value" style="color: var(--houston-red); font-weight: bold;">
                                ${formatCurrency(details.amountOwed)}
                            </span>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h4>Eviction Details</h4>
                        <div class="detail-item">
                            <span class="detail-label">Reason:</span>
                            <span class="detail-value">${details.reason}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Notice Date:</span>
                            <span class="detail-value">${details.noticeDate}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Notice Details:</span>
                            <span class="detail-value">${details.noticeDetails}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">E-Signature:</span>
                            <span class="detail-value">
                                ${details.signature ? 
                                    '<span style="color: var(--success-green);"><i class="fas fa-check-circle"></i> Signed</span>' : 
                                    '<span style="color: var(--houston-red);"><i class="fas fa-times-circle"></i> Missing</span>'}
                            </span>
                        </div>
                    </div>
                </div>
                
                <div class="detail-section">
                    <h4>Generated Documents</h4>
                    <div class="documents-list" id="documentsList">
                        ${documentsHtml}
                    </div>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 30px; justify-content: center;">
                    <button class="btn btn-primary" id="downloadAllCaseDocs">
                        <i class="fas fa-download"></i> Download All Documents
                    </button>
                    ${caseItem.status === 'submitted' ? `
                    <button class="btn btn-success" id="approveThisCase" data-id="${caseItem.id}">
                        <i class="fas fa-check"></i> Approve Case
                    </button>
                    <button class="btn btn-outline" id="rejectThisCase" data-id="${caseItem.id}" style="color: var(--houston-red); border-color: var(--houston-red);">
                        <i class="fas fa-times"></i> Reject Case
                    </button>
                    ` : ''}
                    ${caseItem.status === 'approved' ? `
                    <button class="btn btn-success" id="assignThisCase" data-id="${caseItem.id}">
                        <i class="fas fa-gavel"></i> Assign Court Case Number
                    </button>
                    ` : ''}
                </div>
            `;
            
            $('#caseDetailsContent').html(caseDetails);
            $('#caseDetailsModal').show();
            
            // Add event listeners for buttons in modal
            $('#downloadAllCaseDocs').click(() => downloadCase(caseItem.id));
            $('#approveThisCase').click(() => approveCase(caseItem.id));
            $('#rejectThisCase').click(() => rejectCase(caseItem.id));
            $('#assignThisCase').click(() => showAssignModal(caseItem.id));
            
            // Document buttons
            $('.view-doc').click(function() {
                const docType = $(this).data('type');
                viewDocument(caseItem.id, docType);
            });
            
            $('.download-doc').click(function() {
                const docType = $(this).data('type');
                downloadDocument(caseItem.id, docType);
            });
        }
        
        function getStatusText(status) {
            const statusMap = {
                submitted: 'Submitted - Pending Review',
                processing: 'Processing',
                approved: 'Approved - Ready for Court',
                rejected: 'Rejected',
                filed: 'Filed with Court'
            };
            return statusMap[status] || status;
        }
        
        function showAssignModal(caseId) {
            $('#assignCaseModal').data('caseId', caseId);
            
            // Set default filing date to today
            const today = new Date().toISOString().split('T')[0];
            $('#filingDate').val(today);
            
            // Clear previous values
            $('#officialCaseNumber').val('');
            $('#clerkNotes').val('');
            
            $('#assignCaseModal').show();
        }
        
        function saveCaseNumber() {
            const caseId = $('#assignCaseModal').data('caseId');
            const officialNumber = $('#officialCaseNumber').val().trim();
            const filingDate = $('#filingDate').val();
            const clerkNotes = $('#clerkNotes').val().trim();
            
            if (!officialNumber) {
                alert('Please enter an official case number.');
                return;
            }
            
            if (!filingDate) {
                alert('Please select a filing date.');
                return;
            }
            
            showLoading('Assigning case number...');
            
            // In a real application, this would make an API call
            setTimeout(() => {
                // Update the case in our data
                const caseIndex = allCases.findIndex(c => c.id === caseId);
                if (caseIndex !== -1) {
                    allCases[caseIndex].status = 'filed';
                    allCases[caseIndex].officialCase = officialNumber;
                    allCases[caseIndex].filingDate = filingDate;
                    allCases[caseIndex].clerkNotes = clerkNotes;
                }
                
                hideLoading();
                hideModals();
                
                // Update table and stats
                if (currentFilter !== 'all') {
                    filterCases(currentFilter);
                } else {
                    updateTable(allCases);
                }
                updateStats();
                
                alert(`Case ${caseId} has been assigned court case number: ${officialNumber}`);
            }, 1000);
        }
        
        function approveCase(caseId) {
            if (!confirm(`Approve case ${caseId}? This will move it to the approved queue for court filing.`)) {
                return;
            }
            
            showLoading('Approving case...');
            
            setTimeout(() => {
                const caseIndex = allCases.findIndex(c => c.id === caseId);
                if (caseIndex !== -1) {
                    allCases[caseIndex].status = 'processing';
                    
                    // Simulate processing delay
                    setTimeout(() => {
                        allCases[caseIndex].status = 'approved';
                        
                        if (currentFilter !== 'all') {
                            filterCases(currentFilter);
                        } else {
                            updateTable(allCases);
                        }
                        updateStats();
                        
                        hideModals();
                    }, 2000);
                }
                
                hideLoading();
            }, 1000);
        }
        
        function rejectCase(caseId) {
            const reason = prompt('Please enter the reason for rejection:', '');
            if (reason === null) return;
            
            showLoading('Rejecting case...');
            
            setTimeout(() => {
                const caseIndex = allCases.findIndex(c => c.id === caseId);
                if (caseIndex !== -1) {
                    allCases[caseIndex].status = 'rejected';
                    allCases[caseIndex].rejectionReason = reason;
                }
                
                if (currentFilter !== 'all') {
                    filterCases(currentFilter);
                } else {
                    updateTable(allCases);
                }
                updateStats();
                
                hideLoading();
                hideModals();
                
                alert(`Case ${caseId} has been rejected.`);
            }, 1000);
        }
        
        function downloadCase(caseId) {
            showLoading('Preparing case download...');
            
            // In a real application, this would generate a ZIP file with all documents
            setTimeout(() => {
                hideLoading();
                alert(`Downloading case ${caseId} documents...\n\nIn a real system, this would download a ZIP file containing all case documents.`);
            }, 1500);
        }
        
        function downloadDocument(caseId, docType) {
            showLoading('Preparing document...');
            
            setTimeout(() => {
                hideLoading();
                alert(`Downloading ${docType} for case ${caseId}...\n\nIn a real system, this would download the PDF document.`);
            }, 1000);
        }
        
        function viewDocument(caseId, docType) {
            alert(`Viewing ${docType} for case ${caseId}...\n\nIn a real system, this would open a PDF viewer.`);
        }
        
        function exportData() {
            showLoading('Generating export...');
            
            setTimeout(() => {
                hideLoading();
                
                // Create CSV content
                let csv = 'Case ID,Landlord,Tenant,Property,Amount,Status,Submitted\n';
                allCases.forEach(caseItem => {
                    csv += `"${caseItem.id}","${caseItem.landlord}","${caseItem.tenant}","${caseItem.property}",${caseItem.amount},${caseItem.status},"${caseItem.submitted}"\n`;
                });
                
                // Create download link
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `eviction-cases-${new Date().toISOString().split('T')[0]}.csv`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
            }, 1500);
        }
        
        function hideModals() {
            $('.modal').hide();
        }
        
        function showLoading(message = 'Loading...') {
            $('#loadingOverlay').show();
        }
        
        function hideLoading() {
            $('#loadingOverlay').hide();
        }
    </script>
</body>
</html>
